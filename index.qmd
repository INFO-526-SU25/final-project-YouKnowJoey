---
title: "Graphically Pawsitive Vibes"
subtitle: "INFO 526 - Summer 2025 - Final Project"
author: 
  - name: "Isle of Dogs"
    affiliations:
      - name: "School of Information, University of Arizona"
description: "This project will graphically depict trends, patterns, and analysis of Animal Shelter data derived from the TidyTuesday initiative. The dataset includes information about animals taken in and released from the shelter; there are variables such as intake type, outcome type, animal type, breed, age, and more. The primary goal of this project is to identify key factors that influence an animals outcome."
format:
   html:
    code-tools: true
    code-overflow: wrap
    embed-resources: true
editor: visual
execute:
  warning: false
  echo: false
---

```{r}
#| label: load-pkgs
#| message: false
#| echo: false

if (!require("pacman")) 
  install.packages("pacman")

pacman::p_load(tidyverse,
               tidytuesdayR,
               formattable,
               dlookr,
               ggplot2,
               scales,
               lubridate)
```

# Graphically Pawsitive Vibes

## Abstract

This project examines factors influencing animal outcomes and adoption timelines at the Long Beach Animal Shelter. The dataset—sourced from TidyTuesday—contains 29,787 records and 22 fields, capturing intake and outcome events for various species in Long Beach, California.

The first goal investigates how intake conditions, species grouping, and age at intake relate to final outcomes. The raw data are cleaned and transformed by parsing the `dob` field into a numeric `age_at_intake`, standardizing `intake_condition` values, and collapsing `animal_type`. Visual analyses reveal which intake conditions are associated with more favorable outcomes, how outcome patterns differ across species groups, and whether age correlates with specific dispositions. These insights may help shelter staff identify high‐risk subgroups and allocate medical or foster resources more effectively.

The second goal analyzes time‐to‐adoption trends from 2021 through 2025. Records with `outcome_type == "adoption"` are filtered, `days_to_adoption` is computed as the difference between `outcome_date` and `intake_date`, and `intake_year` is derived. Visualizations illustrate how adoption lengths have shifted over time. This highlights whether animals find homes more quickly in recent years and identifies factors that drive those improvements. These findings could inform capacity planning, guide medical staffing decisions for long‐stay cases, and serve as benchmarks for continuous improvement in shelter performance.

## Introduction

The Long Beach Animal Shelter dataset (TidyTuesday week 2025-03-04) captures 29,787 intake and outcome records from 2021–2025, sourced from the City of Long Beach Animal Care Services open data portal. It includes 22 fields such as `intake_date`, `outcome_date`, `intake_condition`, `animal_type`, `outcome_type`, `dob`, and geolocation, providing a rich mix of categorical, date, and numeric variables.

This project visualizes which intake scenarios and animal characteristics predict different outcomes, and how quickly animals find homes over time. By looking at a variety of visualizations, we hope to provide insight into how intake conditions and animal types affect the animal's outcome and how species and intake conditions influenced the time to adoption. This information could deliver actionable insights for shelter staff on resource allocation and policy planning.

## Data Loading and Cleaning

Load the Longbeach dataset from TidyTuesday

```{r}
longbeach <- tt_load("2025-03-04")
longbeach = longbeach$longbeach
```

Before diving into our analyses, we perform several key data‐wrangling steps to ensure consistency and create the variables we need. First, we standardize the `intake_condition` text by trimming extra whitespace, replacing slashes with spaces, and converting to lowercase. Next, we collapse the many values of `animal_type` into a three-level factor—Dog, Cat, and Other—so we can directly compare these groups. We also calculate each animal’s age at intake (in years) from its date of birth, flagging missing values as “Unknown.” Finally, we derive `days_to_adoption` by subtracting `intake_date` from `outcome_date`, which sets us up to explore adoption timelines.

```{r}
longbeach_clean <- longbeach |>
  
  # standardize intake_condition
  mutate(
    intake_condition = intake_condition |>
      str_squish()             # collapse multiple spaces
      |> str_replace_all("/", " ")  # replace slashes with spaces
      |> str_to_lower()             # convert to lowercase
  ) |>
  
  # create a simplified species_group
  mutate(
    species_group = case_when(
      animal_type == "dog" ~ "Dog",
      animal_type == "cat" ~ "Cat",
      TRUE ~ "Other"
    ) |> 
      factor(levels = c("Dog", "Cat", "Other"))
  ) |>
  
  # compute age_at_intake and flag unknowns
  mutate(
    age_at_intake = as.numeric(intake_date - dob) / 365,
    age_unknown   = is.na(age_at_intake)
  ) |>
  
  # compute days_to_adoption
  mutate(
    days_to_adoption = as.integer(outcome_date - intake_date)
  )
```

#### Analysis of Data

To establish the rationale for combining `animal_type` into Dog, Cat, and Other, horizontal bar chart of the various values of `animal_type` are shown with colot highlighting the grouping.

```{r}
longbeach_clean |>
  count(animal_type, species_group, sort = TRUE) |>
  ggplot(aes(x = n, y = reorder(animal_type, n), fill = species_group)) +
    geom_col() +
    geom_text(aes(label = n),
              hjust = -0.1,
              size = 3) +
    scale_x_continuous(
      expand = expansion(mult = c(0, 0.05)),
      labels = scales::comma_format()
    ) +
    labs(
      title = "Animal Intakes by Type (Dog, Cat, Other)",
      subtitle = "Shelter intakes, 2021–2025",
      x = "Number of Intakes",
      y  = "Animal Type",
      fill = "Species Group",
      caption = "Source: City of Long Beach Animal Care Services (TidyTuesday 2025-03-04)"
    ) +
    scale_fill_discrete(
      breaks = c("Cat", "Dog", "Other")
    ) +
    theme_minimal() +
    theme(
      plot.title.position = "plot",
      plot.title = element_text(face = "bold", hjust = 0.1, size = 12),
      plot.subtitle = element_text(hjust = 0.07, size = 10),
      axis.text = element_text(size = 10),
      plot.caption = element_text(margin = margin(t = 13)),
      legend.position = "inside",
      legend.position.inside = c(0.9, 0.5),
      legend.background = element_rect(fill = "white")
    )

```

## Question 1: How do intake conditions and animal types affect the animal's outcome?

### Introduction:

### Approach (1-2 paragraphs):

### Analysis (2-3 code blocks, 2 figures, text/code comments as needed):

### Discussion (1-3 paragraphs):

## Question 2: How Have Adoption Timelines Evolved (2021–2025)?

### Introduction:

Tracking changes in adoption timelines from 2021 to 2025 is important for shelter capacity planning and improving animal welfare, since faster adoptions free up space and resources for incoming intakes. Examining these trends by species and intake condition also lets us evaluate the impact of recent outreach and medical initiatives and guide future program investments.

### Approach:

**Plot 1** is a line chart of median days_to_adoption over intake_year, with separate lines colored by intake_condition and facets for each species_group. Line charts display trends over time and allow comparison across multiple conditions in a single view.

**Plot 2** is a violin plot that shows the full distribution of days_to_adoption for each year, with fill mapped to intake_condition and facets by species_group. Violin plots show how the shape and range of adoption delays shift over the 2021–2025 period. This informs us whether shelter practices have reduced long‐stay outliers.

### Analysis:

```{r}
adopt_df <- longbeach_clean |>
  filter(outcome_type == "adoption", !is.na(days_to_adoption)) |>
  mutate(intake_year = year(intake_date))
```

#### Plot 1

```{r}
adopt_df |>
  group_by(intake_year, intake_condition, species_group) |>
  summarise(median_days = median(days_to_adoption), .groups = "drop") |>
  ggplot(aes(x = intake_year, y = median_days, color = intake_condition)) +
    geom_line(linewidth = 1) +           # use linewidth instead of size
    facet_wrap(~ species_group) +
    scale_y_continuous("Median Days to Adoption") +
    labs(
      x     = "Intake Year",
      color = "Intake Condition",
      title = "Median Time to Adoption by Year, Condition, and Species Group"
    )

```

#### Plot 2

```{r}

adopt_df |>
  group_by(intake_year, species_group, intake_condition) |>
  filter(n() >= 2) |>
  ungroup() |>
  ggplot(aes(x = factor(intake_year), y = days_to_adoption, fill = intake_condition)) +
    geom_violin(trim = FALSE) +
    facet_wrap(~ species_group) +
    labs(
      x = "Intake Year",
      y = "Days to Adoption",
      fill = "Intake Condition",
      title = "Distribution of Adoption Delays by Year, Condition, and Species Group"
    ) +
    scale_y_continuous(labels = scales::comma_format()) +
    theme_minimal()
```

### Discussion (1-3 paragraphs):
